{% docs table__signers %}
Table of signing key and certificates for EUDCC and ICAO VDS certifications.

Introduced during the COVID-19 pandemic, these are standards which can be
used to produce a QR code containing vaccine information and a digital signature
which certifies that the vaccines were administered by a competent authority.

Digital signatures are issued using a key which is rotated every three months,
and which is itself signed by a Certificate Authority. A country's CA is trusted
by verifying authorities such as the ICAO or EU. This completes the trust chain.

Tamanu generates keys and Certificate Signing Requests in this table. The secret
key material never leaves the server which generates it. CSRs are signed by the
country Health CA, which then returns a Certificate, which is loaded in Tamanu.

There are two sets of dates associated with each Signing Key:
- the validity period propagates to the Digital Signatures on the QR codes; and
  is generally set to 10 years.
- the working period defines when the Signing Key is rotated.

When a key is rotated, the secret material may be erased to ensure the key can
never be used again; the public information is kept forever.

There is always at most one row in this table which has a NULL `certificate`
field; this is the pending CSR.

The Signing Key in use is the row which has a NON-NULL `certificate`, a validity
and working period encompassing the current time, a NON-NULL `private_key`, and
is the newest within that set.

See also the `certifiable_vaccines` table.

This table is present on Facility Servers, but never populated.
{% enddocs %}

{% docs signers__country_code %}
ISO country code for the Health CA.
{% enddocs %}

{% docs signers__private_key %}
Private key data.

This is stored encrypted at rest, using the configuration key `integrations.signer.keySecret`.
{% enddocs %}

{% docs signers__public_key %}
Public key data.
{% enddocs %}

{% docs signers__request %}
Certificate Signing Request.
{% enddocs %}

{% docs signers__certificate %}
Signed Certificate (signed by the Health CA).
{% enddocs %}

{% docs signers__validity_period_start %}
Before that date, the key cannot be used, and signatures generated by it cannot be trusted.
{% enddocs %}

{% docs signers__validity_period_end %}
After that date, the key cannot be used, and signatures generated by it cannot be trusted.
{% enddocs %}

{% docs signers__signatures_issued %}
Counter of digital signatures issued from this key.

This can be used for statistical purposes or for usage policy. For example, one
could specify that kyes should be rotated every three months or every 1000
signatures, whichever comes first.
{% enddocs %}

{% docs signers__request_sent_at %}
Date at which the CSR was sent to be signed by the Health CA.
{% enddocs %}

{% docs signers__working_period_start %}
Before that date, the key cannot be used.
{% enddocs %}

{% docs signers__working_period_end %}
After that date, the key cannot be used.

After that date, the private key may also be nulled.

This is always less than or equal to `validity_period_end`.
{% enddocs %}
