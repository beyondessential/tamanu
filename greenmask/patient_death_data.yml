---
schema: public
name: patient_death_data
transformers:
  - name: Template
    params:
      column: external_cause_date
      template: >
        {{- if isNull .GetValue -}}
          {{- null -}}
        {{- else -}}
          {{- fakerDate -}}
        {{- end -}}

  - name: Template
    params:
      column: last_surgery_date
      template: >
        {{- if isNull .GetValue -}}
          {{- null -}}
        {{- else -}}
          {{- fakerDate -}}
        {{- end -}}

  - name: RealAddress
    params:
      columns:
        - name: external_cause_location
          template: '{{.Address}} {{.City}}'
          keep_null: true

  - name: Masking
    params:
      column: external_cause_notes

  - name: Masking
    params:
      column: manner