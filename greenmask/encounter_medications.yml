---
schema: public
name: encounter_medications
transformers:
  - name: Template
    params:
      column: date
      template: '{{- fakerTimestamp -}}'

  - name: Template
    params:
      column: end_date
      template: >
        {{- if isNull .GetValue -}}
          {{- null -}}
        {{- else -}}
          {{- fakerTimestamp -}}
        {{- end -}}

  - name: Masking
    params:
      column: prescription

  - name: Masking
    params:
      column: note

  - name: Masking
    params:
      column: indication

  - name: Template
    params:
      column: discontinued_date
      template: >
        {{- if isNull .GetValue -}}
          {{- null -}}
        {{- else -}}
          {{- fakerTimestamp -}}
        {{- end -}}

  - name: Masking
    params:
      column: discontinuing_reason

  - name: SetNull
    params:
      column: date_legacy
  - name: SetNull
    params:
      column: end_date_legacy
