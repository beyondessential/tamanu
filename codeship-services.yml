app:
  build: .
  encrypted_env_file: codeship.env.encrypted
  volumes:
    - ./.tmp:/tamanu
    - ./.ssh:/root/.ssh
  environment:
    ELECTRON_CONFIG_CACHE: "$HOME/cache/electron"

app_with_mongo:
  <<: *app
  depends_on:
    - mongodb

awsdeployment:
  build:
    dockerfile: Dockerfile.deploy
  encrypted_env_file: codeship.env.encrypted
  volumes:
    - ./.tmp:/tamanu
    - ./.ssh:/root/.ssh

mongodb:
  image: healthcheck/mongo
  ports:
      - 27017:27017
