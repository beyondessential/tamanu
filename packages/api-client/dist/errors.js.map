{"version":3,"sources":["../src/errors.ts"],"sourcesContent":["import { VERSION_COMPATIBILITY_ERRORS } from '@tamanu/constants';\n\nimport { ResponseError } from './fetch';\n\nexport class ServerResponseError extends Error { }\nexport class AuthExpiredError extends ServerResponseError { }\nexport class VersionIncompatibleError extends ServerResponseError { }\nexport class ServerUnavailableError extends Error {}\n\nexport function getVersionIncompatibleMessage(\n  error: ResponseError,\n  response: Response,\n): string | null {\n  if (error.message === VERSION_COMPATIBILITY_ERRORS.LOW) {\n    const minAppVersion = response.headers.get('X-Min-Client-Version');\n    return `Please upgrade to Tamanu Desktop v${minAppVersion} or higher. Try closing and reopening, or contact your system administrator.`;\n  }\n\n  if (error.message === VERSION_COMPATIBILITY_ERRORS.HIGH) {\n    const maxAppVersion = response.headers.get('X-Max-Client-Version');\n    return `The Tamanu LAN Server only supports up to v${maxAppVersion}, and needs to be upgraded. Please contact your system administrator.`;\n  }\n\n  return null;\n}\n"],"names":["ServerResponseError","AuthExpiredError","VersionIncompatibleError","ServerUnavailableError","getVersionIncompatibleMessage","Error","error","response","message","VERSION_COMPATIBILITY_ERRORS","LOW","minAppVersion","headers","get","HIGH","maxAppVersion"],"mappings":";;;;;;;;;;;IAIaA,mBAAmB,MAAnBA;IACAC,gBAAgB,MAAhBA;IACAC,wBAAwB,MAAxBA;IACAC,sBAAsB,MAAtBA;IAEGC,6BAA6B,MAA7BA;;2BAT6B;AAItC,IAAA,AAAMJ,sBAAN,MAAMA,4BAA4BK;AAAQ;AAC1C,IAAA,AAAMJ,mBAAN,MAAMA,yBAAyBD;AAAsB;AACrD,IAAA,AAAME,2BAAN,MAAMA,iCAAiCF;AAAsB;AAC7D,IAAA,AAAMG,yBAAN,MAAMA,+BAA+BE;AAAO;AAE5C,SAASD,8BACdE,KAAoB,EACpBC,QAAkB,EACH;IACf,IAAID,MAAME,OAAO,KAAKC,uCAA4B,CAACC,GAAG,EAAE;QACtD,MAAMC,gBAAgBJ,SAASK,OAAO,CAACC,GAAG,CAAC;QAC3C,OAAO,CAAC,kCAAkC,EAAEF,cAAc,4EAA4E,CAAC;IACzI,CAAC;IAED,IAAIL,MAAME,OAAO,KAAKC,uCAA4B,CAACK,IAAI,EAAE;QACvD,MAAMC,gBAAgBR,SAASK,OAAO,CAACC,GAAG,CAAC;QAC3C,OAAO,CAAC,2CAA2C,EAAEE,cAAc,qEAAqE,CAAC;IAC3I,CAAC;IAED,OAAO,IAAI;AACb"}